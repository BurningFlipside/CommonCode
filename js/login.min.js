function login_submit_done(d){console.log(d);if(d.status!=200){var b=getParameterByName("failed")*1;var a=window.location;b++;window.location="https://profiles.burningflipside.com/login.php?failed="+b+"&return="+a}else{if(d.responseJSON!==undefined){var e=d.responseJSON;var c="";if(e["return"]){c=e["return"]}else{c=window.location}if(e.extended){}window.location=c}}}function login_submitted(f){f.preventDefault();var c=$("body").data("login-url");if(c===undefined){var b=$("script[src*=login]").attr("src");var a=b.split("/").pop();b=b.replace("/"+a,"");a=b.split("/").pop();b=b.replace("/"+a,"");c=b+"/api/v1/login"}var d=f.target.form;$.ajax({url:c,data:$(d).serialize(),type:"post",dataType:"json",complete:login_submit_done});return false}function login_dialog_shown(){$("[name=username]").focus()}function do_login_init(){var a=$("ul a[href*=login]");if(browser_supports_cors()){a.attr("data-toggle","modal");a.attr("data-target","#login-dialog");a.removeAttr("href");a.css("cursor","pointer");a=$("#content a[href*='login']");a.attr("data-toggle","modal");a.attr("data-target","#login-dialog");a.removeAttr("href");a.css("cursor","pointer")}else{a.attr("href",a.attr("href")+"?return="+document.URL)}if($("#login_main_form").length>0){$("#login_main_form :submit").on("click",login_submitted)}if($("#login_dialog_form").length>0){$("#login_dialog_form :submit").on("click",login_submitted)}if($("#login-dialog").length>0){$("#login-dialog").modal({show:false,backdrop:"static"});$("#login-dialog").on("shown.bs.modal",login_dialog_shown)}}$(do_login_init);