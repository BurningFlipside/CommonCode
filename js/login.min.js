function login_submit_done(o){if(console.log(o),200!=o.status){var t=1*getParameterByName("failed"),i=window.location;t++,window.location="https://profiles.burningflipside.com/login.php?failed="+t+"&return="+i}else if(void 0!==o.responseJSON){var n=o.responseJSON,e="";n["return"]?e=n["return"]:(e=getParameterByName("return"),null===e&&(e=window.location)),n.extended,window.location=e}}function login_submitted(o){o.preventDefault();var t=$("body").data("login-url");if(void 0===t){var i=$("script[src*=login]").attr("src"),n=i.split("/").pop();i=i.replace("/"+n,""),n=i.split("/").pop(),i=i.replace("/"+n,""),t=i+"/api/v1/login"}var e=o.target.form;return $.ajax({url:t,data:$(e).serialize(),type:"post",dataType:"json",complete:login_submit_done}),!1}function login_dialog_shown(){$("[name=username]").focus()}function do_login_init(){var o=$("ul a[href*=login]");browser_supports_cors()?(o.attr("data-toggle","modal"),o.attr("data-target","#login-dialog"),o.removeAttr("href"),o.css("cursor","pointer"),o=$("#content a[href*='login']"),o.attr("data-toggle","modal"),o.attr("data-target","#login-dialog"),o.removeAttr("href"),o.css("cursor","pointer")):o.attr("href",o.attr("href")+"?return="+document.URL),$("#login_main_form").length>0&&$("#login_main_form :submit").on("click",login_submitted),$("#login_dialog_form").length>0&&$("#login_dialog_form :submit").on("click",login_submitted),$("#login-dialog").length>0&&($("#login-dialog").modal({show:!1,backdrop:"static"}),$("#login-dialog").on("shown.bs.modal",login_dialog_shown))}$(do_login_init);
